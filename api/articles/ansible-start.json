{"title":"ansible初识","slug":"ansible-start","date":"2019-02-16T16:19:10.000Z","updated":"2021-03-11T06:05:23.316Z","comments":true,"excerpt":"","content":"<h2 id=\"Why\"><a href=\"#Why\" class=\"headerlink\" title=\"Why\"></a>Why</h2><p>Every time when install a new server, it really take some time to install these or those tools, i want to make this shit a auto way, and Ansible is born for that.</p>\n<h2 id=\"Prepare\"><a href=\"#Prepare\" class=\"headerlink\" title=\"Prepare\"></a>Prepare</h2><p>What you should need to do for the server is just to install it, for me, ubuntu 18.04, and just make sure ssh works.</p>\n<h2 id=\"install-ansible\"><a href=\"#install-ansible\" class=\"headerlink\" title=\"install ansible\"></a>install ansible</h2><p>pip install ansible</p>\n<h2 id=\"ansible-python-interpreter\"><a href=\"#ansible-python-interpreter\" class=\"headerlink\" title=\"ansible_python_interpreter\"></a>ansible_python_interpreter</h2><p>touch /etc/ansible/hosts<br>vim /etc/ansible/hosts</p>\n<p><code>ssh-copy-id yourname@yourserver</code></p>\n<pre><code class=\"txt\">[test]  # group name\n192.168.1.103   #remote server address\n</code></pre>\n<p>ansible test -m ping</p>\n<pre><code class=\"txt\">192.168.1.103 | FAILED! =&gt; {\n    &quot;changed&quot;: false,\n    &quot;module_stderr&quot;: &quot;Shared connection to 192.168.1.103 closed.\\r\\n&quot;,\n    &quot;module_stdout&quot;: &quot;/bin/sh: 1: /usr/bin/python: not found\\r\\n&quot;,\n    &quot;msg&quot;: &quot;MODULE FAILURE\\nSee stdout/stderr for the exact error&quot;,\n    &quot;rc&quot;: 127\n}\n</code></pre>\n<p>that’s because it cant find python in path:/usr/bin/python on remote server, for me ubuntu 18.04 only installed python3, there are 2 solution.<br>1)<code>sudo apt install python</code> on remote server.<br>2) edit /etc/ansible/hosts to config ansible_python_interpreter:<br>eg:192.168.1.103 ansible_python_interpreter=/usr/bin/python3<br>or maybe) you can link python3 to python on remote server (not recommended)</p>\n<pre><code class=\"txt\">192.168.1.103 | SUCCESS =&gt; {\n    &quot;changed&quot;: false,\n    &quot;ping&quot;: &quot;pong&quot;\n}\n</code></pre>\n<p>cd yourpath , mkdir roles, cd roles<br>ansible-galaxy init your-role-name</p>\n","categories":[{"name":"operation","path":"api/categories/operation.json"}],"tags":[{"name":"ForRemember","path":"api/tags/ForRemember.json"}]}